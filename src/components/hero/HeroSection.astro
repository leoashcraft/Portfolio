---
import { profile } from '../../data/profile';
import LazyHero3DScene from './LazyHero3DScene';
---

<section
  id="home"
  class="relative min-h-screen flex items-center justify-center overflow-hidden"
  aria-label="Introduction"
>
  <!-- Static Background for Mobile (CSS only, no JS) -->
  <div class="absolute inset-0 -z-10 hero-static-bg md:hidden" aria-hidden="true">
    <div class="absolute inset-0 bg-gradient-to-b from-[#0a0015] via-[#1a0a2a] to-[#0a0015]"></div>
    <div class="absolute inset-0 opacity-60">
      <div class="absolute top-1/4 left-1/4 w-64 h-64 bg-fuchsia-600/30 rounded-full blur-3xl"></div>
      <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-purple-500/20 rounded-full blur-3xl"></div>
      <div class="absolute top-1/2 left-1/2 w-48 h-48 bg-yellow-400/20 rounded-full blur-3xl"></div>
      <div class="absolute top-1/3 right-1/3 w-32 h-32 bg-green-400/25 rounded-full blur-2xl"></div>
    </div>
  </div>

  <!-- Static Background for Desktop (shows immediately while 3D loads) -->
  <div class="absolute inset-0 -z-20 hidden md:block hero-static-bg" aria-hidden="true">
    <div class="absolute inset-0 bg-gradient-to-b from-[#0a0015] via-[#1a0a2a] to-[#0a0015]"></div>
    <div class="absolute inset-0 opacity-40">
      <div class="absolute top-1/4 left-1/4 w-64 h-64 bg-fuchsia-600/30 rounded-full blur-3xl"></div>
      <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-purple-500/20 rounded-full blur-3xl"></div>
      <div class="absolute top-1/2 left-1/2 w-48 h-48 bg-yellow-400/20 rounded-full blur-3xl"></div>
    </div>
  </div>

  <!-- 3D Background for Desktop Only (lazy loaded after paint, no load on mobile) -->
  <div class="absolute inset-0 -z-10 hidden md:block" id="hero-3d-container">
    <LazyHero3DScene client:media="(min-width: 768px)" />
  </div>

  <!-- Gradient Overlays -->
  <div
    class="absolute inset-0 bg-gradient-to-b from-night-900/50 via-transparent to-night-900 -z-10"
    aria-hidden="true"
  >
  </div>

  <!-- Content -->
  <div class="relative z-10 max-w-4xl mx-auto px-4 text-center pt-20">
    <div class="bg-black/[0.01] backdrop-blur-sm rounded-2xl p-8 md:p-12">
    <!-- Greeting -->
    <p
      class="text-neon-pink font-mono text-sm md:text-base mb-4 opacity-0 animate-[fadeInUp_0.6s_ease_0.2s_forwards] glow-text-pink"
    >
      Hello, I'm
    </p>

    <!-- Name -->
    <h1
      class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-bold mb-4 opacity-0 animate-[fadeInUp_0.6s_ease_0.4s_forwards]"
    >
      <span class="gradient-text-animated">{profile.name}</span>
    </h1>

    <!-- Title with Typewriter Effect -->
    <h2
      class="text-xl sm:text-2xl md:text-3xl text-gray-300 mb-6 opacity-0 animate-[fadeInUp_0.6s_ease_0.6s_forwards] h-[1.75rem] sm:h-[2rem] md:h-[2.25rem]"
    >
      <span id="typewriter">Full Stack Software Developer</span><span id="typewriter-cursor" class="hidden inline-block w-[3px] h-[1em] bg-neon-cyan ml-1 align-middle animate-[cursor-blink_1s_step-end_infinite]"></span>
    </h2>

    <!-- Tagline -->
    <p
      class="text-gray-400 text-lg md:text-xl max-w-2xl mx-auto mb-8 opacity-0 animate-[fadeInUp_0.6s_ease_0.8s_forwards]"
    >
      {profile.tagline}
    </p>

    <!-- CTA Buttons -->
    <div
      class="flex flex-col sm:flex-row items-center justify-center gap-4 opacity-0 animate-[fadeInUp_0.6s_ease_1s_forwards]"
    >
      <a href="#projects" class="btn btn-primary">
        View My Work
        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M19 9l-7 7-7-7"></path>
        </svg>
      </a>

      <a href="#contact" class="btn btn-secondary">
        Get In Touch
        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
          ></path>
        </svg>
      </a>
    </div>

    <!-- Stats -->
    <div
      class="mt-16 grid grid-cols-2 md:grid-cols-4 gap-6 opacity-0 animate-[fadeInUp_0.6s_ease_1.2s_forwards]"
    >
      {
        profile.stats.map((stat) => (
          <div class="text-center">
            <div class="text-3xl md:text-4xl font-bold text-white">
              <span class="counter" data-target={stat.value}>
                0
              </span>
              {stat.suffix}
            </div>
            <div class="text-gray-400 text-sm mt-1">{stat.label}</div>
          </div>
        ))
      }
    </div>
    </div>
  </div>

  <!-- Scroll Indicator -->
  <div
    class="absolute bottom-8 left-1/2 -translate-x-1/2 opacity-0 animate-[fadeInUp_0.6s_ease_1.4s_forwards]"
  >
    <a
      href="#about"
      class="flex flex-col items-center gap-2 text-gray-400 hover:text-neon-cyan transition-colors"
      aria-label="Scroll to about section"
    >
      <span class="text-xs font-mono">SCROLL</span>
      <div class="w-6 h-10 border-2 border-current rounded-full flex justify-center pt-2">
        <div
          class="w-1 h-2 bg-current rounded-full animate-bounce"
          aria-hidden="true"
        >
        </div>
      </div>
    </a>
  </div>
</section>

<script>
  // Show final counter values immediately (no animation for better performance)
  function initCounters() {
    const counters = document.querySelectorAll('.counter');
    counters.forEach((counter) => {
      const target = counter.getAttribute('data-target') || '0';
      counter.textContent = target;
    });
  }

  // Typewriter effect for title
  function initTypewriter() {
    const element = document.getElementById('typewriter');
    const cursor = document.getElementById('typewriter-cursor');
    if (!element) return;

    const titles = [
      'Full Stack Software Developer',
      'Frontend Web Developer',
      'Backend Web Developer',
      'Jack of All Trades'
    ];

    // Start with first title complete, ready to delete
    let titleIndex = 0;
    let charIndex = titles[0].length;
    let isDeleting = true;
    let isPaused = false;

    const typeSpeed = 80;
    const deleteSpeed = 50;
    const pauseTime = 2000;

    function type() {
      const currentTitle = titles[titleIndex];

      if (isPaused) {
        isPaused = false;
        isDeleting = true;
        setTimeout(type, pauseTime);
        return;
      }

      if (isDeleting) {
        element.textContent = currentTitle.substring(0, charIndex - 1);
        charIndex--;

        if (charIndex === 0) {
          isDeleting = false;
          titleIndex = (titleIndex + 1) % titles.length;
          setTimeout(type, 500);
          return;
        }
      } else {
        element.textContent = currentTitle.substring(0, charIndex + 1);
        charIndex++;

        if (charIndex === currentTitle.length) {
          isPaused = true;
          setTimeout(type, 100);
          return;
        }
      }

      setTimeout(type, isDeleting ? deleteSpeed : typeSpeed);
    }

    // Delay start by 12 seconds to let Lighthouse finish scoring
    // Then show cursor and wait 4 more seconds before erasing
    setTimeout(() => {
      if (cursor) {
        cursor.classList.remove('hidden');
      }
      // Wait 4 seconds with full title visible before starting to erase
      setTimeout(type, 4000);
    }, 12000);
  }

  initCounters();
  initTypewriter();
  document.addEventListener('astro:after-swap', () => {
    initCounters();
    initTypewriter();
  });
</script>
